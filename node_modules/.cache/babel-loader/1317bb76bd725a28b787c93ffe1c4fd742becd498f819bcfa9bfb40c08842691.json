{"ast":null,"code":"//处理请求拦截和响应拦截\n\n//引入\n\nimport axios from \"axios\";\nimport { config } from \"dotenv\";\n\n//判断一下用户是否登录\n\nfunction getToken() {\n  //获取token\n  return sessionStorage.getItem('token');\n}\n\n//3创建axios实例\n\nlet service = axios.create({\n  baseURL: \"/api\",\n  timeout: 6000,\n  withCredentials: true\n});\n\n//4创建请求拦截和响应拦截\nservice.interceptors.request.use(\n//成功\nconfig => {\n  if (getToken()) {\n    config.headers['token'] = getToken();\n  }\n  //返回\n  return config;\n},\n//错误\nerr => {\n  return Promise.reject(err);\n});\n//响应拦截\nservice.interceptors.response.use(\n//成功\nresponse => {\n  let res = response.data;\n  if (res.code == '401') {\n    window.location.href = '/login';\n  }\n  return Promise.resolve(res);\n},\n//错误\nerr => {\n  return Promise.reject(err);\n});\nexport default service;","map":{"version":3,"names":["axios","config","getToken","sessionStorage","getItem","service","create","baseURL","timeout","withCredentials","interceptors","request","use","headers","err","Promise","reject","response","res","data","code","window","location","href","resolve"],"sources":["D:/Ceshi/music/src/request/service.js"],"sourcesContent":["//处理请求拦截和响应拦截\r\n\r\n//引入\r\n\r\nimport axios  from \"axios\";\r\nimport { config } from \"dotenv\";\r\n\r\n\r\n//判断一下用户是否登录\r\n\r\nfunction getToken(){ //获取token\r\n  return sessionStorage.getItem('token')\r\n}\r\n\r\n//3创建axios实例\r\n\r\nlet service = axios.create({\r\n  baseURL:\"/api\",\r\n  timeout:6000,\r\n  withCredentials:true\r\n})\r\n\r\n//4创建请求拦截和响应拦截\r\n  service.interceptors.request.use(\r\n    //成功\r\n    config=>{\r\n      if(getToken()){\r\n        config.headers['token']=getToken();\r\n      }\r\n      //返回\r\n      return config\r\n    },\r\n    //错误\r\n    err=>{\r\n      return Promise.reject(err)\r\n    }\r\n  )\r\n  //响应拦截\r\n  service.interceptors.response.use(\r\n    //成功\r\n    response=>{\r\n      \r\n      let res = response.data\r\n      if(res.code=='401'){\r\n        window.location.href='/login'\r\n      }\r\n      return Promise.resolve(res)\r\n    },\r\n    //错误\r\n    err=>{\r\n      return Promise.reject(err)\r\n    }\r\n  )\r\n\r\n  export default service"],"mappings":"AAAA;;AAEA;;AAEA,OAAOA,KAAK,MAAO,OAAO;AAC1B,SAASC,MAAM,QAAQ,QAAQ;;AAG/B;;AAEA,SAASC,QAAQA,CAAA,EAAE;EAAE;EACnB,OAAOC,cAAc,CAACC,OAAO,CAAC,OAAO,CAAC;AACxC;;AAEA;;AAEA,IAAIC,OAAO,GAAGL,KAAK,CAACM,MAAM,CAAC;EACzBC,OAAO,EAAC,MAAM;EACdC,OAAO,EAAC,IAAI;EACZC,eAAe,EAAC;AAClB,CAAC,CAAC;;AAEF;AACEJ,OAAO,CAACK,YAAY,CAACC,OAAO,CAACC,GAAG;AAC9B;AACAX,MAAM,IAAE;EACN,IAAGC,QAAQ,CAAC,CAAC,EAAC;IACZD,MAAM,CAACY,OAAO,CAAC,OAAO,CAAC,GAACX,QAAQ,CAAC,CAAC;EACpC;EACA;EACA,OAAOD,MAAM;AACf,CAAC;AACD;AACAa,GAAG,IAAE;EACH,OAAOC,OAAO,CAACC,MAAM,CAACF,GAAG,CAAC;AAC5B,CACF,CAAC;AACD;AACAT,OAAO,CAACK,YAAY,CAACO,QAAQ,CAACL,GAAG;AAC/B;AACAK,QAAQ,IAAE;EAER,IAAIC,GAAG,GAAGD,QAAQ,CAACE,IAAI;EACvB,IAAGD,GAAG,CAACE,IAAI,IAAE,KAAK,EAAC;IACjBC,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAC,QAAQ;EAC/B;EACA,OAAOR,OAAO,CAACS,OAAO,CAACN,GAAG,CAAC;AAC7B,CAAC;AACD;AACAJ,GAAG,IAAE;EACH,OAAOC,OAAO,CAACC,MAAM,CAACF,GAAG,CAAC;AAC5B,CACF,CAAC;AAED,eAAeT,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}